# CareerCompass Deployment Guide for Render

This guide will help you deploy your CareerCompass application to Render.com.

## Prerequisites

1. **GitHub Repository**: Push your code to a GitHub repository
2. **Render Account**: Sign up at [render.com](https://render.com)
3. **Clerk Account**: Set up authentication at [clerk.com](https://clerk.com)

## Deployment Steps

### Step 1: Prepare Your Repository

1. **Commit all changes** to your GitHub repository:
   ```bash
   git add .
   git commit -m "Add Render deployment configuration"
   git push origin main
   ```

2. **Make build scripts executable** (if on Linux/Mac):
   ```bash
   chmod +x backend/render-build.sh
   chmod +x frontend/render-build.sh
   ```

### Step 2: Deploy to Render

#### Option A: Using render.yaml (Recommended)

1. **Connect Repository**:
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New" â†’ "Blueprint"
   - Connect your GitHub repository
   - Select the repository containing CareerCompass

2. **Configure Blueprint**:
   - Render will automatically detect the `render.yaml` file
   - Review the services that will be created:
     - Backend API (Node.js web service)
     - Frontend (Static site)
     - Worker (Background jobs)
     - MongoDB database
     - Redis cache

3. **Set Environment Variables**:
   - **Backend Service**:
     ```
     CLERK_PUBLISHABLE_KEY=pk_test_your_key_here
     CLERK_SECRET_KEY=sk_test_your_secret_here
     ```
   - **Frontend Service**:
     ```
     VITE_CLERK_PUBLISHABLE_KEY=pk_test_your_key_here
     ```

#### Option B: Manual Service Creation

If you prefer to create services manually:

1. **Create Backend Service**:
   - Type: Web Service
   - Build Command: `cd backend && npm ci && npm run build`
   - Start Command: `cd backend && npm start`
   - Environment: Node

2. **Create Frontend Service**:
   - Type: Static Site
   - Build Command: `cd frontend && npm ci && npm run build`
   - Publish Directory: `frontend/dist`

3. **Create Databases**:
   - MongoDB: Create a new PostgreSQL database (or use MongoDB Atlas)
   - Redis: Create a new Redis instance

### Step 3: Configure Environment Variables

#### Backend Environment Variables
Set these in your backend service settings:

```env
NODE_ENV=production
PORT=5000
MONGO_URI=[Auto-generated by Render]
REDIS_URL=[Auto-generated by Render]
JWT_SECRET=[Generate a secure random string]
JWT_REFRESH_SECRET=[Generate a secure random string]
CLERK_PUBLISHABLE_KEY=[From Clerk Dashboard]
CLERK_SECRET_KEY=[From Clerk Dashboard]
USE_MOCK_AI=true
USE_MOCK_EMBEDDINGS=true
```

#### Frontend Environment Variables
Set these in your frontend service settings:

```env
VITE_API_URL=[Your backend service URL]
VITE_CLERK_PUBLISHABLE_KEY=[From Clerk Dashboard]
```

### Step 4: Configure Clerk Authentication

1. **Update Clerk Settings**:
   - Go to your Clerk Dashboard
   - Add your Render URLs to allowed origins:
     - `https://your-frontend-app.onrender.com`
     - `https://your-backend-app.onrender.com`

2. **Update CORS in Backend**:
   - Ensure your backend allows requests from your frontend URL

### Step 5: Database Setup

#### MongoDB Configuration
If using MongoDB Atlas (recommended):

1. Create a MongoDB Atlas cluster
2. Get the connection string
3. Add it to your backend environment variables as `MONGO_URI`

#### Redis Configuration
Render will provide a Redis instance automatically if using the blueprint.

### Step 6: Verify Deployment

1. **Check Service Status**:
   - All services should show "Live" status
   - Check logs for any errors

2. **Test Application**:
   - Visit your frontend URL
   - Test user registration/login
   - Verify API endpoints are working

3. **Monitor Performance**:
   - Check service metrics in Render dashboard
   - Monitor response times and error rates

## Troubleshooting

### Common Issues

1. **Build Failures**:
   - Check that all dependencies are in package.json
   - Verify build commands are correct
   - Check Node.js version compatibility

2. **Environment Variable Issues**:
   - Ensure all required variables are set
   - Check variable names match exactly
   - Verify Clerk keys are correct

3. **Database Connection Issues**:
   - Verify MongoDB connection string
   - Check network access settings
   - Ensure database user has proper permissions

4. **CORS Issues**:
   - Add frontend URL to backend CORS configuration
   - Update Clerk allowed origins

### Performance Optimization

1. **Enable Caching**:
   - Configure Redis for session storage
   - Implement API response caching

2. **Optimize Build**:
   - Use production builds
   - Enable compression
   - Optimize images and assets

3. **Monitor Resources**:
   - Watch memory usage
   - Monitor database performance
   - Set up alerts for downtime

## Scaling Considerations

1. **Upgrade Plans**: Start with Starter plans, upgrade as needed
2. **Database Scaling**: Consider MongoDB Atlas for better scaling
3. **CDN**: Use Render's CDN for static assets
4. **Load Balancing**: Render handles this automatically

## Security Checklist

- [ ] JWT secrets are secure and unique
- [ ] Clerk keys are properly configured
- [ ] Database access is restricted
- [ ] HTTPS is enabled (automatic on Render)
- [ ] Environment variables are not exposed in frontend
- [ ] CORS is properly configured

## Support

- **Render Documentation**: [render.com/docs](https://render.com/docs)
- **Render Community**: [community.render.com](https://community.render.com)
- **Clerk Documentation**: [clerk.com/docs](https://clerk.com/docs)

## Estimated Costs

- **Starter Plan**: $7/month per service
- **Database**: $7/month for PostgreSQL, varies for MongoDB Atlas
- **Redis**: $7/month
- **Total**: ~$35-50/month for full stack

Your CareerCompass application should now be successfully deployed to Render! ðŸš€
